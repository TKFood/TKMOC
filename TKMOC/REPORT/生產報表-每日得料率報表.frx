<?xml version="1.0" encoding="utf-8"?>
<Report ScriptLanguage="CSharp" ReportInfo.Created="08/08/2019 10:36:52" ReportInfo.Modified="12/24/2019 11:42:03" ReportInfo.CreatorVersion="2016.4.4.0">
  <Dictionary>
    <MsSqlDataConnection Name="Connection" ConnectionString="rijcmlqHwzMSgwTFaHpjtG3vsOj8Zy6q+uhwpDsytgWqwZQZyEQUQyQ022aWUGqU90pHzzNjHuzu89K+RQ2LIBVx1fpgNkNJhwC4eetn2/Uy0fMrO7zDUE5AmRb+0bcYI+lxqpNK7VAg28EMb2zujBtCWMs8uR7KE3TT1XHtlPqNg0WX9JUt+KbXklNrfRqq5Jm7UsZ">
      <TableDataSource Name="Table" DataType="System.Int32" Enabled="true" SelectCommand="SELECT 線別,SUBSTRING(製令單號,1,8) AS '日期'&#13;&#10;,SUM(分子) AS '入庫淨重'&#13;&#10;,SUM(分母) AS '製造投入量'&#13;&#10;,CASE WHEN  SUM(領料扣成品扣的投入量+領料扣成品不扣的投入量+領料不扣成品扣的投入量+領料不扣成品不扣的投入量+半成品得料率成品扣袋重的投入量+半成品得料率成品不扣袋重的投入量+個試吃的投入量+片的投入量+單包的投入量+kg的投入量)&gt;0 THEN SUM(領料扣成品扣的入庫量+領料扣成品不扣的入庫量+領料不扣成品扣的入庫量+領料不扣成品不扣的入庫量+半成品得料率成品扣袋重的入庫量+半成品得料率成品不扣袋重的入庫量+個試吃的入庫量+片的入庫量+單包的入庫量+kg的入庫量)/SUM(領料扣成品扣的投入量+領料扣成品不扣的投入量+領料不扣成品扣的投入量+領料不扣成品不扣的投入量+半成品得料率成品扣袋重的投入量+半成品得料率成品不扣袋重的投入量+個試吃的投入量+片的投入量+單包的投入量+kg的投入量) ELSE 0 END  AS '得料率(%)'&#13;&#10;,ISNULL((SELECT [NGCOOK] FROM  [TKMOC].[dbo].[MOCDAILYRECORDNG] WHERE CONVERT(nvarchar,[DATES],112)=SUBSTRING(製令單號,1,8)  AND MOCLINE=線別),0) AS '可回收-烘焙不良品 	'&#13;&#10;,ISNULL((SELECT [NGCOOL] FROM  [TKMOC].[dbo].[MOCDAILYRECORDNG] WHERE CONVERT(nvarchar,[DATES],112)=SUBSTRING(製令單號,1,8)  AND MOCLINE=線別),0) AS '打餅區落地-冷卻不良品'&#13;&#10;,ISNULL((SELECT [NGPACKF] FROM  [TKMOC].[dbo].[MOCDAILYRECORDNG] WHERE CONVERT(nvarchar,[DATES],112)=SUBSTRING(製令單號,1,8)  AND MOCLINE=線別),0) AS '前端-包裝不良品'&#13;&#10;,ISNULL((SELECT [NGPACKB] FROM  [TKMOC].[dbo].[MOCDAILYRECORDNG] WHERE CONVERT(nvarchar,[DATES],112)=SUBSTRING(製令單號,1,8)  AND MOCLINE=線別),0) AS '後端落地-包裝不良品'&#13;&#10;,(ISNULL((SELECT [NGCOOK] FROM  [TKMOC].[dbo].[MOCDAILYRECORDNG] WHERE CONVERT(nvarchar,[DATES],112)=SUBSTRING(製令單號,1,8)  AND MOCLINE=線別) ,0)+ISNULL((SELECT [NGCOOL] FROM  [TKMOC].[dbo].[MOCDAILYRECORDNG] WHERE CONVERT(nvarchar,[DATES],112)=SUBSTRING(製令單號,1,8) AND MOCLINE=線別),0)+ISNULL((SELECT [NGPACKF] FROM  [TKMOC].[dbo].[MOCDAILYRECORDNG] WHERE CONVERT(nvarchar,[DATES],112)=SUBSTRING(製令單號,1,8) AND MOCLINE=線別),0)+ISNULL((SELECT [NGPACKB] FROM  [TKMOC].[dbo].[MOCDAILYRECORDNG] WHERE CONVERT(nvarchar,[DATES],112)=SUBSTRING(製令單號,1,8) AND MOCLINE=線別),0)) AS '不良合計'&#13;&#10;,CASE WHEN  SUM(領料扣成品扣的投入量+領料扣成品不扣的投入量+領料不扣成品扣的投入量+領料不扣成品不扣的投入量+半成品得料率成品扣袋重的投入量+半成品得料率成品不扣袋重的投入量+個試吃的投入量+片的投入量+單包的投入量+kg的投入量)&gt;0 THEN (ISNULL((SELECT [NGCOOK] FROM  [TKMOC].[dbo].[MOCDAILYRECORDNG] WHERE CONVERT(nvarchar,[DATES],112)=SUBSTRING(製令單號,1,8) AND MOCLINE=線別),0)+ISNULL((SELECT [NGCOOL] FROM  [TKMOC].[dbo].[MOCDAILYRECORDNG] WHERE CONVERT(nvarchar,[DATES],112)=SUBSTRING(製令單號,1,8) AND MOCLINE=線別),0)+ISNULL((SELECT [NGPACKF] FROM  [TKMOC].[dbo].[MOCDAILYRECORDNG] WHERE CONVERT(nvarchar,[DATES],112)=SUBSTRING(製令單號,1,8) AND MOCLINE=線別),0)+ISNULL((SELECT [NGPACKB] FROM  [TKMOC].[dbo].[MOCDAILYRECORDNG] WHERE CONVERT(nvarchar,[DATES],112)=SUBSTRING(製令單號,1,8) AND MOCLINE=線別),0))/SUM(領料扣成品扣的投入量+領料扣成品不扣的投入量+領料不扣成品扣的投入量+領料不扣成品不扣的投入量+半成品得料率成品扣袋重的投入量+半成品得料率成品不扣袋重的投入量+個試吃的投入量+片的投入量+單包的投入量+kg的投入量) ELSE 0 END  AS '報廢率(％)'&#13;&#10;&#13;&#10;FROM &#13;&#10;(&#13;&#10;SELECT &#13;&#10;線別,品號,品名,製令單別,製令單號,生產單位,類別,領料是否扣袋重,成品是否扣袋重,生產量,淨重,單片重,袋重,袋重比,蒸發率,原料用量,成品用量/1000 AS 成品用量&#13;&#10;,CASE WHEN 領料是否扣袋重 IN ('Y') AND 成品是否扣袋重 IN ('Y') AND  類別 NOT IN ('半成品','個','試吃','片','單包','kg') AND (原料用量*(1-(蒸發率/100))+(成品用量/1000)-(袋重比*原料用量))&gt;0 THEN (生產量*淨重*(1-袋重比)/1000) ELSE 0 END  AS '領料扣成品扣的入庫量'&#13;&#10;,CASE WHEN 領料是否扣袋重 IN ('Y') AND 成品是否扣袋重 IN ('Y') AND  類別 NOT IN ('半成品','個','試吃','片','單包','kg') AND (原料用量*(1-(蒸發率/100))+(成品用量/1000)-(袋重比*原料用量))&gt;0 THEN (原料用量*(1-(蒸發率/100))+(成品用量/1000)-(袋重比*原料用量)) ELSE 0 END  AS '領料扣成品扣的投入量'&#13;&#10;,CASE WHEN 領料是否扣袋重 IN ('Y') AND 成品是否扣袋重 IN ('N') AND  類別 NOT IN ('半成品','個','試吃','片','單包','kg') AND (原料用量*(1-(蒸發率/100))+(成品用量/1000))&gt;0 THEN ((生產量*淨重)/1000) ELSE 0 END AS '領料扣成品不扣的入庫量'&#13;&#10;,CASE WHEN 領料是否扣袋重 IN ('Y') AND 成品是否扣袋重 IN ('N') AND  類別 NOT IN ('半成品','個','試吃','片','單包','kg') AND (原料用量*(1-(蒸發率/100))+(成品用量/1000))&gt;0 THEN (原料用量*(1-蒸發率)+(成品用量/1000)-(袋重比*原料用量)) ELSE 0 END AS '領料扣成品不扣的投入量'&#13;&#10;,CASE WHEN 領料是否扣袋重 IN ('N') AND 成品是否扣袋重 IN ('Y') AND  類別 NOT IN ('半成品','個','試吃','片','單包','kg') AND (原料用量*(1-(蒸發率/100))+(成品用量/1000)-(袋重比*原料用量))&gt;0 THEN (((生產量*淨重*(1-袋重比)))/1000) ELSE 0 END AS '領料不扣成品扣的入庫量'&#13;&#10;,CASE WHEN 領料是否扣袋重 IN ('N') AND 成品是否扣袋重 IN ('Y') AND  類別 NOT IN ('半成品','個','試吃','片','單包','kg') AND (原料用量*(1-(蒸發率/100))+(成品用量/1000)-(袋重比*原料用量))&gt;0 THEN (原料用量*(1-(蒸發率/100))+(成品用量/1000)) ELSE 0 END AS '領料不扣成品扣的投入量'&#13;&#10;,CASE WHEN 領料是否扣袋重 IN ('N') AND 成品是否扣袋重 IN ('N') AND  類別 NOT IN ('半成品','個','試吃','片','單包','kg') AND (原料用量*(1-(蒸發率/100))+(成品用量/1000))&gt;0 THEN ((生產量*淨重)/1000) ELSE 0 END AS '領料不扣成品不扣的入庫量'&#13;&#10;,CASE WHEN 領料是否扣袋重 IN ('N') AND 成品是否扣袋重 IN ('N') AND  類別 NOT IN ('半成品','個','試吃','片','單包','kg') AND (原料用量*(1-(蒸發率/100))+(成品用量/1000))&gt;0 THEN (原料用量*(1-(蒸發率/100))+(成品用量/1000)) ELSE 0 END AS '領料不扣成品不扣的投入量'&#13;&#10;,CASE WHEN 類別 IN ('半成品') AND 原料用量&gt;0  AND 成品是否扣袋重 IN ('Y') THEN (生產量-(生產量*袋重比)) ELSE 0 END  AS '半成品得料率成品扣袋重的入庫量'&#13;&#10;,CASE WHEN 類別 IN ('半成品') AND 原料用量&gt;0  AND 成品是否扣袋重 IN ('Y') THEN (原料用量*(1-蒸發率/100)) ELSE 0 END  AS '半成品得料率成品扣袋重的投入量'&#13;&#10;,CASE WHEN 類別 IN ('半成品') AND 原料用量&gt;0  AND 成品是否扣袋重 IN ('N') THEN (生產量) ELSE 0 END  AS '半成品得料率成品不扣袋重的入庫量'&#13;&#10;,CASE WHEN 類別 IN ('半成品') AND 原料用量&gt;0  AND 成品是否扣袋重 IN ('N') THEN (原料用量*(1-蒸發率/100)) ELSE 0 END  AS '半成品得料率成品不扣袋重的投入量'&#13;&#10;,CASE WHEN 類別 IN ('個','試吃') AND 原料用量&gt;0 AND (原料用量*(1-(蒸發率/100)))&gt;0 THEN (生產量*淨重/1000) ELSE 0 END  AS '個試吃的入庫量'&#13;&#10;,CASE WHEN 類別 IN ('個','試吃') AND 原料用量&gt;0 AND (原料用量*(1-(蒸發率/100)))&gt;0 THEN (原料用量*(1-(蒸發率/100))) ELSE 0 END  AS '個試吃的投入量'&#13;&#10;,CASE WHEN 類別 IN ('片') AND 原料用量&gt;0 AND (原料用量*(1-(蒸發率/100))-(原料用量*袋重比))&gt;0 THEN (生產量*淨重/1000) ELSE 0 END  AS '片的入庫量'&#13;&#10;,CASE WHEN 類別 IN ('片') AND 原料用量&gt;0 AND (原料用量*(1-(蒸發率/100))-(原料用量*袋重比))&gt;0 THEN (原料用量*(1-(蒸發率/100))-(原料用量*袋重比)) ELSE 0 END  AS '片的投入量'&#13;&#10;,CASE WHEN 類別 IN ('單包') AND 原料用量&gt;0 THEN 生產量  ELSE 0 END AS '單包的入庫量'&#13;&#10;,CASE WHEN 類別 IN ('單包') AND 原料用量&gt;0 THEN 原料用量  ELSE 0 END AS '單包的投入量'&#13;&#10;,CASE WHEN 類別 IN ('kg') AND (原料用量*(1-(蒸發率/100))-(原料用量*袋重比))&gt;0 THEN (生產量) ELSE 0 END AS 'kg的入庫量'&#13;&#10;,CASE WHEN 類別 IN ('kg') AND (原料用量*(1-(蒸發率/100))-(原料用量*袋重比))&gt;0 THEN (原料用量*(1-(蒸發率/100))+(成品用量/1000)-(原料用量*袋重比)) ELSE 0 END AS 'kg的投入量'&#13;&#10;&#13;&#10;,CASE WHEN 領料是否扣袋重 IN ('Y') AND 成品是否扣袋重 IN ('Y') AND  類別 NOT IN ('半成品','個','試吃','片','單包','kg') AND (原料用量*(1-(蒸發率/100))+(成品用量/1000)-(袋重比*原料用量))&gt;0 THEN (((生產量*淨重*(1-袋重比)))/1000)/(原料用量*(1-(蒸發率/100))+(成品用量/1000)-(袋重比*原料用量)) ELSE 0 END  AS '領料扣成品扣的得料率'&#13;&#10;,CASE WHEN 領料是否扣袋重 IN ('Y') AND 成品是否扣袋重 IN ('N') AND  類別 NOT IN ('半成品','個','試吃','片','單包','kg') AND (原料用量*(1-(蒸發率/100))+(成品用量/1000))&gt;0 THEN (((生產量*淨重))/1000)/(原料用量*(1-蒸發率)+(成品用量/1000)-(袋重比*原料用量)) ELSE 0 END AS '領料扣成品不扣的得料率'&#13;&#10;,CASE WHEN 領料是否扣袋重 IN ('N') AND 成品是否扣袋重 IN ('Y') AND  類別 NOT IN ('半成品','個','試吃','片','單包','kg') AND (原料用量*(1-(蒸發率/100))+(成品用量/1000)-(袋重比*原料用量))&gt;0 THEN (((生產量*淨重*(1-袋重比)))/1000)/(原料用量*(1-(蒸發率/100))+(成品用量/1000)) ELSE 0 END AS '領料不扣成品扣的得料率'&#13;&#10;,CASE WHEN 領料是否扣袋重 IN ('N') AND 成品是否扣袋重 IN ('N') AND  類別 NOT IN ('半成品','個','試吃','片','單包','kg') AND (原料用量*(1-(蒸發率/100))+(成品用量/1000))&gt;0 THEN (((生產量*淨重)/1000)/(原料用量*(1-(蒸發率/100))+(成品用量/1000))) ELSE 0 END AS '領料不扣成品不扣的得料率'&#13;&#10;,CASE WHEN 類別 IN ('半成品') AND 原料用量&gt;0  AND 成品是否扣袋重 IN ('Y') THEN (生產量-(生產量*袋重比))/(原料用量*(1-蒸發率/100)) ELSE 0 END  AS '半成品得料率(成品扣袋重)'&#13;&#10;,CASE WHEN 類別 IN ('半成品') AND 原料用量&gt;0  AND 成品是否扣袋重 IN ('N') THEN (生產量)/(原料用量*(1-蒸發率/100)) ELSE 0 END  AS '半成品得料率(成品不扣袋重)'&#13;&#10;,CASE WHEN 類別 IN ('個','試吃') AND 原料用量&gt;0 AND (原料用量*(1-(蒸發率/100)))&gt;0 THEN (生產量*淨重/1000)/(原料用量*(1-(蒸發率/100))) ELSE 0 END  AS '個/試吃得料率'&#13;&#10;,CASE WHEN 類別 IN ('片') AND 原料用量&gt;0 AND (原料用量*(1-(蒸發率/100))-(原料用量*袋重比))&gt;0 THEN (生產量*淨重/1000)/(原料用量*(1-(蒸發率/100))-(原料用量*袋重比)) ELSE 0 END  AS '片得料率'&#13;&#10;,CASE WHEN 類別 IN ('單包') AND 原料用量&gt;0 THEN 生產量/原料用量  ELSE 0 END AS '單包得料率'&#13;&#10;,CASE WHEN 類別 IN ('kg') AND (原料用量*(1-(蒸發率/100))-(原料用量*袋重比))&gt;0 THEN ((生產量)/(原料用量*(1-(蒸發率/100))+(成品用量/1000)-(原料用量*袋重比))) ELSE 0 END AS 'kg得料率'&#13;&#10;,(CASE WHEN 領料是否扣袋重 IN ('Y') AND 成品是否扣袋重 IN ('Y') AND  類別 NOT IN ('半成品','個','試吃','片','單包','kg') AND (原料用量*(1-(蒸發率/100))+(成品用量/1000)-(袋重比*原料用量))&gt;0 THEN (((生產量*淨重*(1-袋重比)))/1000)/(原料用量*(1-(蒸發率/100))+(成品用量/1000)-(袋重比*原料用量)) ELSE 0 END)+(CASE WHEN 領料是否扣袋重 IN ('Y') AND 成品是否扣袋重 IN ('N') AND  類別 NOT IN ('半成品','個','試吃','片','單包','kg') AND (原料用量*(1-(蒸發率/100))+(成品用量/1000))&gt;0 THEN (((生產量*淨重))/1000)/(原料用量*(1-蒸發率)+(成品用量/1000)-(袋重比*原料用量)) ELSE 0 END)+(CASE WHEN 領料是否扣袋重 IN ('N') AND 成品是否扣袋重 IN ('Y') AND  類別 NOT IN ('半成品','個','試吃','片','單包','kg') AND (原料用量*(1-(蒸發率/100))+(成品用量/1000)-(袋重比*原料用量))&gt;0 THEN (((生產量*淨重*(1-袋重比)))/1000)/(原料用量*(1-(蒸發率/100))+(成品用量/1000)) ELSE 0 END)+(CASE WHEN 領料是否扣袋重 IN ('N') AND 成品是否扣袋重 IN ('N') AND  類別 NOT IN ('半成品','個','試吃','片','單包','kg') AND (原料用量*(1-(蒸發率/100))+(成品用量/1000))&gt;0 THEN (((生產量*淨重)/1000)/(原料用量*(1-(蒸發率/100))+(成品用量/1000))) ELSE 0 END)+(CASE WHEN 類別 IN ('半成品') AND 原料用量&gt;0  AND 成品是否扣袋重 IN ('Y') THEN (生產量-(生產量*袋重比))/(原料用量*(1-蒸發率/100)) ELSE 0 END)+(CASE WHEN 類別 IN ('半成品') AND 原料用量&gt;0  AND 成品是否扣袋重 IN ('N') THEN (生產量)/(原料用量*(1-蒸發率/100)) ELSE 0 END)+(CASE WHEN 類別 IN ('個','試吃') AND 原料用量&gt;0 AND (原料用量*(1-(蒸發率/100)))&gt;0 THEN (生產量*淨重/1000)/(原料用量*(1-(蒸發率/100))) ELSE 0 END)+(CASE WHEN 類別 IN ('片') AND 原料用量&gt;0 AND (原料用量*(1-(蒸發率/100))-(原料用量*袋重比))&gt;0 THEN (生產量*淨重/1000)/(原料用量*(1-(蒸發率/100))-(原料用量*袋重比)) ELSE 0 END)+(CASE WHEN 類別 IN ('單包') AND 原料用量&gt;0 THEN 生產量/原料用量  ELSE 0 END)+(CASE WHEN 類別 IN ('kg') AND (原料用量*(1-(蒸發率/100))-(原料用量*袋重比))&gt;0 THEN ((生產量)/(原料用量*(1-(蒸發率/100))+(成品用量/1000)-(原料用量*袋重比))) ELSE 0 END) AS '得料率'&#13;&#10;,(CASE WHEN 領料是否扣袋重 IN ('Y') AND 成品是否扣袋重 IN ('Y') AND  類別 NOT IN ('半成品','個','試吃','片','單包','kg') AND (原料用量*(1-(蒸發率/100))+(成品用量/1000)-(袋重比*原料用量))&gt;0 THEN (((生產量*淨重*(1-袋重比)))/1000) ELSE 0 END)+(CASE WHEN 領料是否扣袋重 IN ('Y') AND 成品是否扣袋重 IN ('N') AND  類別 NOT IN ('半成品','個','試吃','片','單包','kg') AND (原料用量*(1-(蒸發率/100))+(成品用量/1000))&gt;0 THEN (((生產量*淨重))/1000) ELSE 0 END)+(CASE WHEN 領料是否扣袋重 IN ('N') AND 成品是否扣袋重 IN ('Y') AND  類別 NOT IN ('半成品','個','試吃','片','單包','kg') AND (原料用量*(1-(蒸發率/100))+(成品用量/1000)-(袋重比*原料用量))&gt;0 THEN (((生產量*淨重*(1-袋重比)))/1000) ELSE 0 END)+(CASE WHEN 領料是否扣袋重 IN ('N') AND 成品是否扣袋重 IN ('N') AND  類別 NOT IN ('半成品','個','試吃','片','單包','kg') AND (原料用量*(1-(蒸發率/100))+(成品用量/1000))&gt;0 THEN ((生產量*淨重)/1000) ELSE 0 END)+(CASE WHEN 類別 IN ('半成品') AND 原料用量&gt;0  AND 成品是否扣袋重 IN ('Y') THEN (生產量-(生產量*袋重比)) ELSE 0 END )+(CASE WHEN 類別 IN ('半成品') AND 原料用量&gt;0  AND 成品是否扣袋重 IN ('N') THEN (生產量) ELSE 0 END)+(CASE WHEN 類別 IN ('個','試吃') AND 原料用量&gt;0 AND (原料用量*(1-(蒸發率/100)))&gt;0 THEN (生產量*淨重/1000) ELSE 0 END)+(CASE WHEN 類別 IN ('片') AND 原料用量&gt;0 AND (原料用量*(1-(蒸發率/100))-(原料用量*袋重比))&gt;0 THEN (生產量*淨重/1000) ELSE 0 END)+(CASE WHEN 類別 IN ('單包') AND 原料用量&gt;0 THEN 生產量  ELSE 0 END)+(CASE WHEN 類別 IN ('kg') AND (原料用量*(1-(蒸發率/100))-(原料用量*袋重比))&gt;0 THEN ((生產量)) ELSE 0 END) AS '分子'&#13;&#10;,(CASE WHEN 領料是否扣袋重 IN ('Y') AND 成品是否扣袋重 IN ('Y') AND  類別 NOT IN ('半成品','個','試吃','片','單包','kg') AND (原料用量*(1-(蒸發率/100))+(成品用量/1000)-(袋重比*原料用量))&gt;0 THEN (原料用量*(1-(蒸發率/100))+(成品用量/1000)-(袋重比*原料用量)) ELSE 0 END)+(CASE WHEN 領料是否扣袋重 IN ('Y') AND 成品是否扣袋重 IN ('N') AND  類別 NOT IN ('半成品','個','試吃','片','單包','kg') AND (原料用量*(1-(蒸發率/100))+(成品用量/1000))&gt;0 THEN (原料用量*(1-蒸發率)+(成品用量/1000)-(袋重比*原料用量)) ELSE 0 END)+(CASE WHEN 領料是否扣袋重 IN ('N') AND 成品是否扣袋重 IN ('Y') AND  類別 NOT IN ('半成品','個','試吃','片','單包','kg') AND (原料用量*(1-(蒸發率/100))+(成品用量/1000)-(袋重比*原料用量))&gt;0 THEN (原料用量*(1-(蒸發率/100))+(成品用量/1000)) ELSE 0 END)+(CASE WHEN 領料是否扣袋重 IN ('N') AND 成品是否扣袋重 IN ('N') AND  類別 NOT IN ('半成品','個','試吃','片','單包','kg') AND (原料用量*(1-(蒸發率/100))+(成品用量/1000))&gt;0 THEN ((原料用量*(1-(蒸發率/100))+(成品用量/1000))) ELSE 0 END)+(CASE WHEN 類別 IN ('半成品') AND 原料用量&gt;0  AND 成品是否扣袋重 IN ('Y') THEN (原料用量*(1-蒸發率/100)) ELSE 0 END)+(CASE WHEN 類別 IN ('半成品') AND 原料用量&gt;0  AND 成品是否扣袋重 IN ('N') THEN (原料用量*(1-蒸發率/100)) ELSE 0 END)+(CASE WHEN 類別 IN ('個','試吃') AND 原料用量&gt;0 AND (原料用量*(1-(蒸發率/100)))&gt;0 THEN (原料用量*(1-(蒸發率/100))) ELSE 0 END)+(CASE WHEN 類別 IN ('片') AND 原料用量&gt;0 AND (原料用量*(1-(蒸發率/100))-(原料用量*袋重比))&gt;0 THEN (原料用量*(1-(蒸發率/100))-(原料用量*袋重比)) ELSE 0 END)+(CASE WHEN 類別 IN ('單包') AND 原料用量&gt;0 THEN 原料用量  ELSE 0 END)+(CASE WHEN 類別 IN ('kg') AND (原料用量*(1-(蒸發率/100))-(原料用量*袋重比))&gt;0 THEN ((原料用量*(1-(蒸發率/100))+(成品用量/1000)-(原料用量*袋重比))) ELSE 0 END) AS '分母'&#13;&#10;FROM(&#13;&#10;SELECT MD002 AS '線別',TA006 AS '品號',TA034 AS '品名',TA001 AS '製令單別',TA002 AS '製令單號',TA007 AS '生產單位',MB114 AS '類別',TA017 AS '生產量',INVMB.UDF07 AS '淨重',INVMB.UDF08 AS '單片重',INVMB.UDF09 AS '袋重',INVMB.UDF06 AS '蒸發率',INVMB.UDF01 AS '成品是否扣袋重',INVMB.UDF02 AS '領料是否扣袋重'&#13;&#10;,(SELECT ISNULL(SUM(TB005),0) FROM [TK].dbo.MOCTB TB WHERE (TB.TB003 LIKE '1%' OR TB.TB003 LIKE '3%') AND TB.TB001=MOCTA.TA001 AND TB.TB002=MOCTA.TA002)  AS '原料用量'&#13;&#10;,(SELECT ISNULL(SUM(TB005*MB.UDF07),0) FROM [TK].dbo.MOCTB TB,[TK].dbo.INVMB MB WHERE TB.TB003=MB.MB001 AND TB.TB003 LIKE '4%' AND TB.TB001=MOCTA.TA001 AND TB.TB002=MOCTA.TA002) AS '成品用量'&#13;&#10;,CASE WHEN INVMB.UDF08&gt;0 AND   INVMB.UDF09&gt;0  THEN 1/(INVMB.UDF08+INVMB.UDF09)*INVMB.UDF09 ELSE 1 END  AS '袋重比'&#13;&#10;FROM [TK].dbo.INVMB,[TK].dbo.MOCTA,[TK].dbo.CMSMD&#13;&#10;WHERE TA006=MB001 AND TA021=MD001&#13;&#10;AND ISNULL(MB114,'')&lt;&gt;''&#13;&#10;AND TA003&gt;='20190902' AND TA003&lt;='20190902'&#13;&#10;) AS TEMP&#13;&#10;) AS TEMP2&#13;&#10;WHERE 線別='新廠製二組' &#13;&#10;GROUP BY 線別,SUBSTRING(製令單號,1,8)&#13;&#10;ORDER BY 線別,SUBSTRING(製令單號,1,8)&#13;&#10;">
        <Column Name="線別" DataType="System.String"/>
        <Column Name="日期" DataType="System.String"/>
        <Column Name="入庫淨重" DataType="System.Decimal"/>
        <Column Name="得料率(%)" DataType="System.Decimal"/>
        <Column Name="可回收-烘焙不良品 	" DataType="System.Decimal"/>
        <Column Name="打餅區落地-冷卻不良品" DataType="System.Decimal"/>
        <Column Name="前端-包裝不良品" DataType="System.Decimal"/>
        <Column Name="後端落地-包裝不良品" DataType="System.Decimal"/>
        <Column Name="不良合計" DataType="System.Decimal"/>
        <Column Name="報廢率(％)" DataType="System.Decimal"/>
        <Column Name="製造投入量" DataType="System.Decimal"/>
      </TableDataSource>
    </MsSqlDataConnection>
    <MsSqlDataConnection Name="Connection1" ConnectionString="rijcmlqHwzMSgwTFaHpjtG3vsOj8Zy6q+uhwpDsytgWqwZQZyEQUQyQ022aWUGqU90pHzzNjHuzu89K+RQ2LIBVx1fpgNkNJhwC4eetn2/Uy0fMrO7zDUE5AmRb+0bcYI+lxqpNK7VAg28EMb2zujBtCWMs8uR7KE3TT1XHtlPqNg0WX9I+phV5wTfn/V9pcnh/w48Z"/>
  </Dictionary>
  <ReportPage Name="Page1" Landscape="true" PaperWidth="297" PaperHeight="210">
    <ReportTitleBand Name="ReportTitle1" Width="1047.06" Height="37.8">
      <TextObject Name="Text1" Width="1039.5" Height="18.9" Text="每日得料率" HorzAlign="Center" VertAlign="Center"/>
    </ReportTitleBand>
    <ColumnHeaderBand Name="ColumnHeader1" Top="41.65" Width="1047.06" Height="28.35">
      <TextObject Name="Text3" Left="-9.45" Width="113.4" Height="28.35" Border.Lines="All" Text="線別" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text5" Left="103.95" Width="75.6" Height="28.35" Border.Lines="All" Text="日期" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text11" Left="340.2" Width="66.15" Height="28.35" Border.Lines="All" Text="得料率(%)" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text13" Left="406.35" Width="75.6" Height="28.35" Border.Lines="All" Text="可回收-烘焙不良品 	" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text15" Left="481.95" Width="85.05" Height="28.35" Border.Lines="All" Text="打餅區落地-冷卻不良品" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text17" Left="567" Width="75.6" Height="28.35" Border.Lines="All" Text="前端-包裝不良品" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text19" Left="642.6" Width="75.6" Height="28.35" Border.Lines="All" Text="後端落地-包裝不良品" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text21" Left="718.2" Width="75.6" Height="28.35" Border.Lines="All" Text="不良合計" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text23" Left="793.8" Width="75.6" Height="28.35" Border.Lines="All" Text="報廢率(％)" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text24" Left="869.4" Width="75.6" Height="28.35" Border.Lines="All" Text="加上報廢的得料率(％)" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text7" Left="179.55" Width="75.6" Height="28.35" Border.Lines="All" Text="製造總產出" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text9" Left="255.15" Width="85.05" Height="28.35" Border.Lines="All" Text="製造投入量" HorzAlign="Center" VertAlign="Center"/>
    </ColumnHeaderBand>
    <DataBand Name="Data1" Top="73.84" Width="1047.06" Height="18.9" DataSource="Table">
      <TextObject Name="Text2" Left="-9.45" Width="113.4" Height="18.9" Border.Lines="All" Text="[Table.線別]" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text4" Left="103.95" Width="75.6" Height="18.9" Border.Lines="All" Text="[Table.日期]" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text10" Left="340.2" Width="66.15" Height="18.9" Border.Lines="All" Text="[Table.得料率(%)]" Format="Percent" Format.UseLocale="true" HorzAlign="Right" VertAlign="Center" WordWrap="false" Trimming="EllipsisCharacter"/>
      <TextObject Name="Text12" Left="406.35" Width="75.6" Height="18.9" Border.Lines="All" Text="[Table.可回收-烘焙不良品 	]" Format="Number" Format.UseLocale="true" HorzAlign="Right" VertAlign="Center" WordWrap="false" Trimming="EllipsisCharacter"/>
      <TextObject Name="Text14" Left="481.95" Width="85.05" Height="18.9" Border.Lines="All" Text="[Table.打餅區落地-冷卻不良品]" Format="Number" Format.UseLocale="true" HorzAlign="Right" VertAlign="Center" WordWrap="false" Trimming="EllipsisCharacter"/>
      <TextObject Name="Text16" Left="567" Width="75.6" Height="18.9" Border.Lines="All" Text="[Table.前端-包裝不良品]" Format="Number" Format.UseLocale="true" HorzAlign="Right" VertAlign="Center" WordWrap="false" Trimming="EllipsisCharacter"/>
      <TextObject Name="Text18" Left="642.6" Width="75.6" Height="18.9" Border.Lines="All" Text="[Table.後端落地-包裝不良品]" Format="Number" Format.UseLocale="true" HorzAlign="Right" VertAlign="Center" WordWrap="false" Trimming="EllipsisCharacter"/>
      <TextObject Name="Text20" Left="718.2" Width="75.6" Height="18.9" Border.Lines="All" Text="[Table.不良合計]" Format="Number" Format.UseLocale="true" HorzAlign="Right" VertAlign="Center" WordWrap="false" Trimming="EllipsisCharacter"/>
      <TextObject Name="Text22" Left="793.8" Width="75.6" Height="18.9" Border.Lines="All" Text="[Table.報廢率(％)]" Format="Percent" Format.UseLocale="true" HorzAlign="Right" VertAlign="Center" WordWrap="false" Trimming="EllipsisCharacter"/>
      <TextObject Name="Text25" Left="869.4" Width="75.6" Height="18.9" Border.Lines="All" Text="[[Table.得料率(%)]+[Table.報廢率(％)]]" Format="Percent" Format.UseLocale="true" HorzAlign="Right" VertAlign="Center" WordWrap="false" Trimming="EllipsisCharacter"/>
      <TextObject Name="Text6" Left="179.55" Width="75.6" Height="18.9" Border.Lines="All" Text="[Table.入庫淨重]" Format="Number" Format.UseLocale="true" HorzAlign="Right" VertAlign="Center" WordWrap="false" Trimming="EllipsisCharacter"/>
      <TextObject Name="Text8" Left="255.15" Width="85.05" Height="18.9" Border.Lines="All" Text="[Table.製造投入量]" Format="Number" Format.UseLocale="true" HorzAlign="Right" VertAlign="Center" WordWrap="false" Trimming="EllipsisCharacter"/>
    </DataBand>
    <PageFooterBand Name="PageFooter1" Top="96.59" Width="1047.06" Height="18.9"/>
  </ReportPage>
</Report>
