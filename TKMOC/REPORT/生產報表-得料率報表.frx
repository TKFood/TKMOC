<?xml version="1.0" encoding="utf-8"?>
<Report ScriptLanguage="CSharp" ReportInfo.Created="08/07/2019 09:01:07" ReportInfo.Modified="04/25/2024 09:19:13" ReportInfo.CreatorVersion="2016.4.4.0">
  <Dictionary>
    <MsSqlDataConnection Name="Connection" ConnectionString="rijcmlqHwzMSgwTFaHpjtG3vsOj8Zy6q+uhwpDsytgWqwZQZyEQUQyQ022aWUGqU90pHzzNjHuzu89K+RQ2LIBVx1fpgNkNJhwC4eetn2/Uy0fMrO7zDUE5AmRb+0bcYI+lxqpNK7VAg28EMb2zujBtCWMs8uR7KE3TT1XHtlPqNg0WX9KRczS0fRrSl61V3umWH5Qs">
      <TableDataSource Name="Table" DataType="System.Int32" Enabled="true" SelectCommand="SELECT 線別&#13;&#10;	,SUBSTRING(製令單號, 1, 8) AS '日期'&#13;&#10;	,品號&#13;&#10;	,品名&#13;&#10;	,規格&#13;&#10;	,製令單別&#13;&#10;	,製令單號&#13;&#10;	,生產單位&#13;&#10;	,預計產量&#13;&#10;	,生產量&#13;&#10;	,桶數&#13;&#10;	,淨重&#13;&#10;	,單片重&#13;&#10;	,袋重&#13;&#10;	,袋重比&#13;&#10;	,蒸發率&#13;&#10;	,原料用量&#13;&#10;	,成品用量 / 1000 AS 成品用量&#13;&#10;	,類別&#13;&#10;	,領料是否扣袋重&#13;&#10;	,成品是否扣袋重&#13;&#10;	,CASE &#13;&#10;		WHEN 領料是否扣袋重 IN ('Y')&#13;&#10;			AND 成品是否扣袋重 IN ('Y')&#13;&#10;			AND 類別 NOT IN (&#13;&#10;				'半成品'&#13;&#10;				,'個'&#13;&#10;				,'試吃'&#13;&#10;				,'片'&#13;&#10;				,'單包'&#13;&#10;				,'kg'&#13;&#10;				)&#13;&#10;			AND (原料用量 * (1 - (蒸發率 / 100)) + (成品用量 / 1000) - (袋重比 * 原料用量)) &gt; 0&#13;&#10;			THEN (((生產量 * 淨重 * (1 - 袋重比))) / 1000) / (原料用量 * (1 - (蒸發率 / 100)) + (成品用量 / 1000) - (袋重比 * 原料用量))&#13;&#10;		ELSE 0&#13;&#10;		END AS '領料扣成品扣的得料率'&#13;&#10;	,CASE &#13;&#10;		WHEN 領料是否扣袋重 IN ('Y')&#13;&#10;			AND 成品是否扣袋重 IN ('N')&#13;&#10;			AND 類別 NOT IN (&#13;&#10;				'半成品'&#13;&#10;				,'個'&#13;&#10;				,'試吃'&#13;&#10;				,'片'&#13;&#10;				,'單包'&#13;&#10;				,'kg'&#13;&#10;				)&#13;&#10;			AND (原料用量 * (1 - (蒸發率 / 100)) + (成品用量 / 1000)) &gt; 0&#13;&#10;			THEN (((生產量 * 淨重)) / 1000) / (原料用量 * (1 - 蒸發率) + (成品用量 / 1000) - (袋重比 * 原料用量))&#13;&#10;		ELSE 0&#13;&#10;		END AS '領料扣成品不扣的得料率'&#13;&#10;	,CASE &#13;&#10;		WHEN 領料是否扣袋重 IN ('N')&#13;&#10;			AND 成品是否扣袋重 IN ('Y')&#13;&#10;			AND 類別 NOT IN (&#13;&#10;				'半成品'&#13;&#10;				,'個'&#13;&#10;				,'試吃'&#13;&#10;				,'片'&#13;&#10;				,'單包'&#13;&#10;				,'kg'&#13;&#10;				)&#13;&#10;			AND (原料用量 * (1 - (蒸發率 / 100)) + (成品用量 / 1000) - (袋重比 * 原料用量)) &gt; 0&#13;&#10;			THEN (((生產量 * 淨重 * (1 - 袋重比))) / 1000) / (原料用量 * (1 - (蒸發率 / 100)) + (成品用量 / 1000))&#13;&#10;		ELSE 0&#13;&#10;		END AS '領料不扣成品扣的得料率'&#13;&#10;	,CASE &#13;&#10;		WHEN 領料是否扣袋重 IN ('N')&#13;&#10;			AND 成品是否扣袋重 IN ('N')&#13;&#10;			AND 類別 NOT IN (&#13;&#10;				'半成品'&#13;&#10;				,'個'&#13;&#10;				,'試吃'&#13;&#10;				,'片'&#13;&#10;				,'單包'&#13;&#10;				,'kg'&#13;&#10;				)&#13;&#10;			AND (原料用量 * (1 - (蒸發率 / 100)) + (成品用量 / 1000)) &gt; 0&#13;&#10;			THEN (((生產量 * 淨重) / 1000) / (原料用量 * (1 - (蒸發率 / 100)) + (成品用量 / 1000)))&#13;&#10;		ELSE 0&#13;&#10;		END AS '領料不扣成品不扣的得料率'&#13;&#10;	,CASE &#13;&#10;		WHEN 類別 IN ('半成品')&#13;&#10;			AND 原料用量 &gt; 0&#13;&#10;			AND 成品是否扣袋重 IN ('Y')&#13;&#10;			THEN (生產量 - (生產量 * 袋重比)) / (原料用量 * (1 - 蒸發率 / 100))&#13;&#10;		ELSE 0&#13;&#10;		END AS '半成品得料率成品扣袋重'&#13;&#10;	,CASE &#13;&#10;		WHEN 類別 IN ('半成品')&#13;&#10;			AND 原料用量 &gt; 0&#13;&#10;			AND 成品是否扣袋重 IN ('N')&#13;&#10;			THEN (生產量) / (原料用量 * (1 - 蒸發率 / 100))&#13;&#10;		ELSE 0&#13;&#10;		END AS '半成品得料率成品不扣袋重'&#13;&#10;	,CASE &#13;&#10;		WHEN 類別 IN (&#13;&#10;				'個'&#13;&#10;				,'試吃'&#13;&#10;				)&#13;&#10;			AND 原料用量 &gt; 0&#13;&#10;			AND (原料用量 * (1 - (蒸發率 / 100))) &gt; 0&#13;&#10;			THEN (生產量 * 淨重 / 1000) / (原料用量 * (1 - (蒸發率 / 100)))&#13;&#10;		ELSE 0&#13;&#10;		END AS '個試吃得料率'&#13;&#10;	,CASE &#13;&#10;		WHEN 類別 IN ('片')&#13;&#10;			AND 原料用量 &gt; 0&#13;&#10;			AND (原料用量 * (1 - (蒸發率 / 100)) - (原料用量 * 袋重比)) &gt; 0&#13;&#10;			THEN (生產量 * 淨重 / 1000) / (原料用量 * (1 - (蒸發率 / 100)) - (原料用量 * 袋重比))&#13;&#10;		ELSE 0&#13;&#10;		END AS '片得料率'&#13;&#10;	,CASE &#13;&#10;		WHEN 類別 IN ('單包')&#13;&#10;			AND 原料用量 &gt; 0&#13;&#10;			THEN 生產量 / 原料用量&#13;&#10;		ELSE 0&#13;&#10;		END AS '單包得料率'&#13;&#10;	,CASE &#13;&#10;		WHEN 類別 IN ('kg')&#13;&#10;			AND (原料用量 * (1 - (蒸發率 / 100)) - (原料用量 * 袋重比)) &gt; 0&#13;&#10;			THEN ((生產量) / (原料用量 * (1 - (蒸發率 / 100)) + (成品用量 / 1000) - (原料用量 * 袋重比)))&#13;&#10;		ELSE 0&#13;&#10;		END AS 'kg得料率'&#13;&#10;	,(&#13;&#10;		CASE &#13;&#10;			WHEN 類別 IN ('過篩後')&#13;&#10;				AND 原料用量 &gt; 0&#13;&#10;				THEN 生產量 / 原料用量&#13;&#10;			ELSE 0&#13;&#10;			END&#13;&#10;		) AS '過篩後得料率'&#13;&#10;	,(&#13;&#10;		CASE &#13;&#10;			WHEN 領料是否扣袋重 IN ('Y')&#13;&#10;				AND 成品是否扣袋重 IN ('Y')&#13;&#10;				AND 類別 NOT IN (&#13;&#10;					'半成品'&#13;&#10;					,'個'&#13;&#10;					,'試吃'&#13;&#10;					,'片'&#13;&#10;					,'單包'&#13;&#10;					,'kg'&#13;&#10;					)&#13;&#10;				AND (原料用量 * (1 - (蒸發率 / 100)) + (成品用量 / 1000) - (袋重比 * 原料用量)) &gt; 0&#13;&#10;				THEN (((生產量 * 淨重 * (1 - 袋重比))) / 1000) / (原料用量 * (1 - (蒸發率 / 100)) + (成品用量 / 1000) - (袋重比 * 原料用量))&#13;&#10;			ELSE 0&#13;&#10;			END&#13;&#10;		) + (&#13;&#10;		CASE &#13;&#10;			WHEN 領料是否扣袋重 IN ('Y')&#13;&#10;				AND 成品是否扣袋重 IN ('N')&#13;&#10;				AND 類別 NOT IN (&#13;&#10;					'半成品'&#13;&#10;					,'個'&#13;&#10;					,'試吃'&#13;&#10;					,'片'&#13;&#10;					,'單包'&#13;&#10;					,'kg'&#13;&#10;					)&#13;&#10;				AND (原料用量 * (1 - (蒸發率 / 100)) + (成品用量 / 1000)) &gt; 0&#13;&#10;				THEN (((生產量 * 淨重)) / 1000) / (原料用量 * (1 - 蒸發率) + (成品用量 / 1000) - (袋重比 * 原料用量))&#13;&#10;			ELSE 0&#13;&#10;			END&#13;&#10;		) + (&#13;&#10;		CASE &#13;&#10;			WHEN 領料是否扣袋重 IN ('N')&#13;&#10;				AND 成品是否扣袋重 IN ('Y')&#13;&#10;				AND 類別 NOT IN (&#13;&#10;					'半成品'&#13;&#10;					,'個'&#13;&#10;					,'試吃'&#13;&#10;					,'片'&#13;&#10;					,'單包'&#13;&#10;					,'kg'&#13;&#10;					)&#13;&#10;				AND (原料用量 * (1 - (蒸發率 / 100)) + (成品用量 / 1000) - (袋重比 * 原料用量)) &gt; 0&#13;&#10;				THEN (((生產量 * 淨重 * (1 - 袋重比))) / 1000) / (原料用量 * (1 - (蒸發率 / 100)) + (成品用量 / 1000))&#13;&#10;			ELSE 0&#13;&#10;			END&#13;&#10;		) + (&#13;&#10;		CASE &#13;&#10;			WHEN 領料是否扣袋重 IN ('N')&#13;&#10;				AND 成品是否扣袋重 IN ('N')&#13;&#10;				AND 類別 NOT IN (&#13;&#10;					'半成品'&#13;&#10;					,'個'&#13;&#10;					,'試吃'&#13;&#10;					,'片'&#13;&#10;					,'單包'&#13;&#10;					,'kg'&#13;&#10;					)&#13;&#10;				AND (原料用量 * (1 - (蒸發率 / 100)) + (成品用量 / 1000)) &gt; 0&#13;&#10;				THEN (((生產量 * 淨重) / 1000) / (原料用量 * (1 - (蒸發率 / 100)) + (成品用量 / 1000)))&#13;&#10;			ELSE 0&#13;&#10;			END&#13;&#10;		) + (&#13;&#10;		CASE &#13;&#10;			WHEN 類別 IN ('半成品')&#13;&#10;				AND 原料用量 &gt; 0&#13;&#10;				AND 成品是否扣袋重 IN ('Y')&#13;&#10;				THEN (生產量 - (生產量 * 袋重比)) / (原料用量 * (1 - 蒸發率 / 100))&#13;&#10;			ELSE 0&#13;&#10;			END&#13;&#10;		) + (&#13;&#10;		CASE &#13;&#10;			WHEN 類別 IN ('半成品')&#13;&#10;				AND 原料用量 &gt; 0&#13;&#10;				AND 成品是否扣袋重 IN ('N')&#13;&#10;				THEN (生產量) / (原料用量 * (1 - 蒸發率 / 100))&#13;&#10;			ELSE 0&#13;&#10;			END&#13;&#10;		) + (&#13;&#10;		CASE &#13;&#10;			WHEN 類別 IN (&#13;&#10;					'個'&#13;&#10;					,'試吃'&#13;&#10;					)&#13;&#10;				AND 原料用量 &gt; 0&#13;&#10;				AND (原料用量 * (1 - (蒸發率 / 100))) &gt; 0&#13;&#10;				THEN (生產量 * 淨重 / 1000) / (原料用量 * (1 - (蒸發率 / 100)))&#13;&#10;			ELSE 0&#13;&#10;			END&#13;&#10;		) + (&#13;&#10;		CASE &#13;&#10;			WHEN 類別 IN ('片')&#13;&#10;				AND 原料用量 &gt; 0&#13;&#10;				AND (原料用量 * (1 - (蒸發率 / 100)) - (原料用量 * 袋重比)) &gt; 0&#13;&#10;				THEN (生產量 * 淨重 / 1000) / (原料用量 * (1 - (蒸發率 / 100)) - (原料用量 * 袋重比))&#13;&#10;			ELSE 0&#13;&#10;			END&#13;&#10;		) + (&#13;&#10;		CASE &#13;&#10;			WHEN 類別 IN ('單包')&#13;&#10;				AND 原料用量 &gt; 0&#13;&#10;				THEN 生產量 / 原料用量&#13;&#10;			ELSE 0&#13;&#10;			END&#13;&#10;		) + (&#13;&#10;		CASE &#13;&#10;			WHEN 類別 IN ('kg')&#13;&#10;				AND (原料用量 * (1 - (蒸發率 / 100)) - (原料用量 * 袋重比)) &gt; 0&#13;&#10;				THEN ((生產量) / (原料用量 * (1 - (蒸發率 / 100)) + (成品用量 / 1000) - (原料用量 * 袋重比)))&#13;&#10;			ELSE 0&#13;&#10;			END&#13;&#10;		)+ (&#13;&#10;		CASE &#13;&#10;			WHEN 類別 IN ('過篩後')&#13;&#10;				AND 原料用量 &gt; 0&#13;&#10;				THEN 生產量 / 原料用量&#13;&#10;			ELSE 0&#13;&#10;			END) AS '得料率'&#13;&#10;	,(&#13;&#10;		CASE &#13;&#10;			WHEN 領料是否扣袋重 IN ('Y')&#13;&#10;				AND 成品是否扣袋重 IN ('Y')&#13;&#10;				AND 類別 NOT IN (&#13;&#10;					'半成品'&#13;&#10;					,'個'&#13;&#10;					,'試吃'&#13;&#10;					,'片'&#13;&#10;					,'單包'&#13;&#10;					,'kg'&#13;&#10;					)&#13;&#10;				AND (原料用量 * (1 - (蒸發率 / 100)) + (成品用量 / 1000) - (袋重比 * 原料用量)) &gt; 0&#13;&#10;				THEN (((生產量 * 淨重 * (1 - 袋重比))) / 1000)&#13;&#10;			ELSE 0&#13;&#10;			END&#13;&#10;		) + (&#13;&#10;		CASE &#13;&#10;			WHEN 領料是否扣袋重 IN ('Y')&#13;&#10;				AND 成品是否扣袋重 IN ('N')&#13;&#10;				AND 類別 NOT IN (&#13;&#10;					'半成品'&#13;&#10;					,'個'&#13;&#10;					,'試吃'&#13;&#10;					,'片'&#13;&#10;					,'單包'&#13;&#10;					,'kg'&#13;&#10;					)&#13;&#10;				AND (原料用量 * (1 - (蒸發率 / 100)) + (成品用量 / 1000)) &gt; 0&#13;&#10;				THEN (((生產量 * 淨重)) / 1000)&#13;&#10;			ELSE 0&#13;&#10;			END&#13;&#10;		) + (&#13;&#10;		CASE &#13;&#10;			WHEN 領料是否扣袋重 IN ('N')&#13;&#10;				AND 成品是否扣袋重 IN ('Y')&#13;&#10;				AND 類別 NOT IN (&#13;&#10;					'半成品'&#13;&#10;					,'個'&#13;&#10;					,'試吃'&#13;&#10;					,'片'&#13;&#10;					,'單包'&#13;&#10;					,'kg'&#13;&#10;					)&#13;&#10;				AND (原料用量 * (1 - (蒸發率 / 100)) + (成品用量 / 1000) - (袋重比 * 原料用量)) &gt; 0&#13;&#10;				THEN (((生產量 * 淨重 * (1 - 袋重比))) / 1000)&#13;&#10;			ELSE 0&#13;&#10;			END&#13;&#10;		) + (&#13;&#10;		CASE &#13;&#10;			WHEN 領料是否扣袋重 IN ('N')&#13;&#10;				AND 成品是否扣袋重 IN ('N')&#13;&#10;				AND 類別 NOT IN (&#13;&#10;					'半成品'&#13;&#10;					,'個'&#13;&#10;					,'試吃'&#13;&#10;					,'片'&#13;&#10;					,'單包'&#13;&#10;					,'kg'&#13;&#10;					)&#13;&#10;				AND (原料用量 * (1 - (蒸發率 / 100)) + (成品用量 / 1000)) &gt; 0&#13;&#10;				THEN ((生產量 * 淨重) / 1000)&#13;&#10;			ELSE 0&#13;&#10;			END&#13;&#10;		) + (&#13;&#10;		CASE &#13;&#10;			WHEN 類別 IN ('半成品')&#13;&#10;				AND 原料用量 &gt; 0&#13;&#10;				AND 成品是否扣袋重 IN ('Y')&#13;&#10;				THEN (生產量 - (生產量 * 袋重比))&#13;&#10;			ELSE 0&#13;&#10;			END&#13;&#10;		) + (&#13;&#10;		CASE &#13;&#10;			WHEN 類別 IN ('半成品')&#13;&#10;				AND 原料用量 &gt; 0&#13;&#10;				AND 成品是否扣袋重 IN ('N')&#13;&#10;				THEN (生產量)&#13;&#10;			ELSE 0&#13;&#10;			END&#13;&#10;		) + (&#13;&#10;		CASE &#13;&#10;			WHEN 類別 IN (&#13;&#10;					'個'&#13;&#10;					,'試吃'&#13;&#10;					)&#13;&#10;				AND 原料用量 &gt; 0&#13;&#10;				AND (原料用量 * (1 - (蒸發率 / 100))) &gt; 0&#13;&#10;				THEN (生產量 * 淨重 / 1000)&#13;&#10;			ELSE 0&#13;&#10;			END&#13;&#10;		) + (&#13;&#10;		CASE &#13;&#10;			WHEN 類別 IN ('片')&#13;&#10;				AND 原料用量 &gt; 0&#13;&#10;				AND (原料用量 * (1 - (蒸發率 / 100)) - (原料用量 * 袋重比)) &gt; 0&#13;&#10;				THEN (生產量 * 淨重 / 1000)&#13;&#10;			ELSE 0&#13;&#10;			END&#13;&#10;		) + (&#13;&#10;		CASE &#13;&#10;			WHEN 類別 IN ('單包')&#13;&#10;				AND 原料用量 &gt; 0&#13;&#10;				THEN 生產量&#13;&#10;			ELSE 0&#13;&#10;			END&#13;&#10;		) + (&#13;&#10;		CASE &#13;&#10;			WHEN 類別 IN ('kg')&#13;&#10;				AND (原料用量 * (1 - (蒸發率 / 100)) - (原料用量 * 袋重比)) &gt; 0&#13;&#10;				THEN ((生產量))&#13;&#10;			ELSE 0&#13;&#10;			END&#13;&#10;		) + (&#13;&#10;		CASE &#13;&#10;			WHEN 類別 IN ('過篩後')&#13;&#10;				AND 原料用量 &gt; 0&#13;&#10;				THEN 生產量&#13;&#10;			ELSE 0&#13;&#10;			END&#13;&#10;		) AS '分子'&#13;&#10;	,(&#13;&#10;		CASE &#13;&#10;			WHEN 領料是否扣袋重 IN ('Y')&#13;&#10;				AND 成品是否扣袋重 IN ('Y')&#13;&#10;				AND 類別 NOT IN (&#13;&#10;					'半成品'&#13;&#10;					,'個'&#13;&#10;					,'試吃'&#13;&#10;					,'片'&#13;&#10;					,'單包'&#13;&#10;					,'kg'&#13;&#10;					)&#13;&#10;				AND (原料用量 * (1 - (蒸發率 / 100)) + (成品用量 / 1000) - (袋重比 * 原料用量)) &gt; 0&#13;&#10;				THEN (原料用量 * (1 - (蒸發率 / 100)) + (成品用量 / 1000) - (袋重比 * 原料用量))&#13;&#10;			ELSE 0&#13;&#10;			END&#13;&#10;		) + (&#13;&#10;		CASE &#13;&#10;			WHEN 領料是否扣袋重 IN ('Y')&#13;&#10;				AND 成品是否扣袋重 IN ('N')&#13;&#10;				AND 類別 NOT IN (&#13;&#10;					'半成品'&#13;&#10;					,'個'&#13;&#10;					,'試吃'&#13;&#10;					,'片'&#13;&#10;					,'單包'&#13;&#10;					,'kg'&#13;&#10;					)&#13;&#10;				AND (原料用量 * (1 - (蒸發率 / 100)) + (成品用量 / 1000)) &gt; 0&#13;&#10;				THEN (原料用量 * (1 - 蒸發率) + (成品用量 / 1000) - (袋重比 * 原料用量))&#13;&#10;			ELSE 0&#13;&#10;			END&#13;&#10;		) + (&#13;&#10;		CASE &#13;&#10;			WHEN 領料是否扣袋重 IN ('N')&#13;&#10;				AND 成品是否扣袋重 IN ('Y')&#13;&#10;				AND 類別 NOT IN (&#13;&#10;					'半成品'&#13;&#10;					,'個'&#13;&#10;					,'試吃'&#13;&#10;					,'片'&#13;&#10;					,'單包'&#13;&#10;					,'kg'&#13;&#10;					)&#13;&#10;				AND (原料用量 * (1 - (蒸發率 / 100)) + (成品用量 / 1000) - (袋重比 * 原料用量)) &gt; 0&#13;&#10;				THEN (原料用量 * (1 - (蒸發率 / 100)) + (成品用量 / 1000))&#13;&#10;			ELSE 0&#13;&#10;			END&#13;&#10;		) + (&#13;&#10;		CASE &#13;&#10;			WHEN 領料是否扣袋重 IN ('N')&#13;&#10;				AND 成品是否扣袋重 IN ('N')&#13;&#10;				AND 類別 NOT IN (&#13;&#10;					'半成品'&#13;&#10;					,'個'&#13;&#10;					,'試吃'&#13;&#10;					,'片'&#13;&#10;					,'單包'&#13;&#10;					,'kg'&#13;&#10;					)&#13;&#10;				AND (原料用量 * (1 - (蒸發率 / 100)) + (成品用量 / 1000)) &gt; 0&#13;&#10;				THEN ((原料用量 * (1 - (蒸發率 / 100)) + (成品用量 / 1000)))&#13;&#10;			ELSE 0&#13;&#10;			END&#13;&#10;		) + (&#13;&#10;		CASE &#13;&#10;			WHEN 類別 IN ('半成品')&#13;&#10;				AND 原料用量 &gt; 0&#13;&#10;				AND 成品是否扣袋重 IN ('Y')&#13;&#10;				THEN (原料用量 * (1 - 蒸發率 / 100))&#13;&#10;			ELSE 0&#13;&#10;			END&#13;&#10;		) + (&#13;&#10;		CASE &#13;&#10;			WHEN 類別 IN ('半成品')&#13;&#10;				AND 原料用量 &gt; 0&#13;&#10;				AND 成品是否扣袋重 IN ('N')&#13;&#10;				THEN (原料用量 * (1 - 蒸發率 / 100))&#13;&#10;			ELSE 0&#13;&#10;			END&#13;&#10;		) + (&#13;&#10;		CASE &#13;&#10;			WHEN 類別 IN (&#13;&#10;					'個'&#13;&#10;					,'試吃'&#13;&#10;					)&#13;&#10;				AND 原料用量 &gt; 0&#13;&#10;				AND (原料用量 * (1 - (蒸發率 / 100))) &gt; 0&#13;&#10;				THEN (原料用量 * (1 - (蒸發率 / 100)))&#13;&#10;			ELSE 0&#13;&#10;			END&#13;&#10;		) + (&#13;&#10;		CASE &#13;&#10;			WHEN 類別 IN ('片')&#13;&#10;				AND 原料用量 &gt; 0&#13;&#10;				AND (原料用量 * (1 - (蒸發率 / 100)) - (原料用量 * 袋重比)) &gt; 0&#13;&#10;				THEN (原料用量 * (1 - (蒸發率 / 100)) - (原料用量 * 袋重比))&#13;&#10;			ELSE 0&#13;&#10;			END&#13;&#10;		) + (&#13;&#10;		CASE &#13;&#10;			WHEN 類別 IN ('單包')&#13;&#10;				AND 原料用量 &gt; 0&#13;&#10;				THEN 原料用量&#13;&#10;			ELSE 0&#13;&#10;			END&#13;&#10;		) + (&#13;&#10;		CASE &#13;&#10;			WHEN 類別 IN ('kg')&#13;&#10;				AND (原料用量 * (1 - (蒸發率 / 100)) - (原料用量 * 袋重比)) &gt; 0&#13;&#10;				THEN ((原料用量 * (1 - (蒸發率 / 100)) + (成品用量 / 1000) - (原料用量 * 袋重比)))&#13;&#10;			ELSE 0&#13;&#10;			END&#13;&#10;		) + (&#13;&#10;		CASE &#13;&#10;			WHEN 類別 IN ('過篩後')&#13;&#10;				AND 原料用量 &gt; 0&#13;&#10;				THEN 原料用量&#13;&#10;			ELSE 0&#13;&#10;			END&#13;&#10;		) AS '分母'&#13;&#10;FROM (&#13;&#10;	SELECT MD002 AS '線別'&#13;&#10;		,TA006 AS '品號'&#13;&#10;		,TA034 AS '品名'&#13;&#10;		,MB003 AS '規格'&#13;&#10;		,TA001 AS '製令單別'&#13;&#10;		,TA002 AS '製令單號'&#13;&#10;		,TA007 AS '生產單位'&#13;&#10;		,INVMB.UDF03 AS '類別'&#13;&#10;		,TA015 AS '預計產量'&#13;&#10;		,TA017 AS '生產量'&#13;&#10;		,INVMB.UDF07 AS '淨重'&#13;&#10;		,INVMB.UDF08 AS '單片重'&#13;&#10;		,INVMB.UDF09 AS '袋重'&#13;&#10;		,INVMB.UDF06 AS '蒸發率'&#13;&#10;		,INVMB.UDF01 AS '成品是否扣袋重'&#13;&#10;		,INVMB.UDF02 AS '領料是否扣袋重'&#13;&#10;		,(&#13;&#10;			(&#13;&#10;				SELECT ISNULL(SUM(TB005), 0)&#13;&#10;				FROM [TK].dbo.MOCTB TB&#13;&#10;				WHERE (&#13;&#10;						TB.TB003 LIKE '1%'&#13;&#10;						OR TB.TB003 LIKE '3%'&#13;&#10;						)&#13;&#10;					AND TB007 IN (&#13;&#10;						'kg'&#13;&#10;						,'KG'&#13;&#10;						,'Kg'&#13;&#10;						,'kG'&#13;&#10;						,'公升'&#13;&#10;						)&#13;&#10;					AND TB.TB001 = MOCTA.TA001&#13;&#10;					AND TB.TB002 = MOCTA.TA002&#13;&#10;				) + (&#13;&#10;				SELECT ISNULL(SUM(TB005 * MB.UDF07 / 1000), 0)&#13;&#10;				FROM [TK].dbo.MOCTB TB&#13;&#10;					,[TK].dbo.INVMB MB&#13;&#10;				WHERE MB.MB001 = TB.TB003&#13;&#10;					AND (&#13;&#10;						TB.TB003 LIKE '3%'&#13;&#10;						AND TB007 NOT IN (&#13;&#10;							'kg'&#13;&#10;							,'KG'&#13;&#10;							,'Kg'&#13;&#10;							,'kG'&#13;&#10;							,'公升'&#13;&#10;							)&#13;&#10;						)&#13;&#10;					AND TB.TB001 = MOCTA.TA001&#13;&#10;					AND TB.TB002 = MOCTA.TA002&#13;&#10;				)&#13;&#10;			) AS '原料用量'&#13;&#10;		,(&#13;&#10;			SELECT ISNULL(SUM(TB005 * MB.UDF07), 0)&#13;&#10;			FROM [TK].dbo.MOCTB TB&#13;&#10;				,[TK].dbo.INVMB MB&#13;&#10;			WHERE TB.TB003 = MB.MB001&#13;&#10;				AND TB.TB003 LIKE '4%'&#13;&#10;				AND TB.TB001 = MOCTA.TA001&#13;&#10;				AND TB.TB002 = MOCTA.TA002&#13;&#10;			) AS '成品用量'&#13;&#10;		,CASE &#13;&#10;			WHEN INVMB.UDF08 &gt; 0&#13;&#10;				AND INVMB.UDF09 &gt; 0&#13;&#10;				THEN 1 / (INVMB.UDF08 + INVMB.UDF09) * INVMB.UDF09&#13;&#10;			ELSE 0&#13;&#10;			END AS '袋重比'&#13;&#10;		,CONVERT(DECIMAL(16, 3), (&#13;&#10;				TA015 / ISNULL((&#13;&#10;						SELECT TOP 1 MC004&#13;&#10;						FROM [TK].dbo.BOMMC&#13;&#10;						WHERE MC001 = MB001&#13;&#10;						), 1)&#13;&#10;				)) AS '桶數'&#13;&#10;	FROM [TK].dbo.INVMB&#13;&#10;		,[TK].dbo.MOCTA&#13;&#10;		,[TK].dbo.CMSMD&#13;&#10;	WHERE TA006 = MB001&#13;&#10;		AND TA021 = MD001&#13;&#10;		--AND ISNULL(INVMB.UDF03,'')&lt;&gt;''&#13;&#10;		AND TA013 IN (&#13;&#10;			'Y'&#13;&#10;			,'N'&#13;&#10;			)&#13;&#10;		AND TA003 &gt;= '20240420'&#13;&#10;		AND TA003 &lt;= '20240424'&#13;&#10;		--AND TA002='20240422017'&#13;&#10;	) AS TEMP&#13;&#10;WHERE 1 = 1&#13;&#10;	AND 線別 = '製二線'&#13;&#10;ORDER BY 線別&#13;&#10;	,SUBSTRING(製令單號, 1, 8)&#13;&#10;	,品號&#13;&#10;">
        <Column Name="線別" DataType="System.String"/>
        <Column Name="日期" DataType="System.String"/>
        <Column Name="品號" DataType="System.String"/>
        <Column Name="品名" DataType="System.String"/>
        <Column Name="規格" DataType="System.String"/>
        <Column Name="製令單別" DataType="System.String"/>
        <Column Name="製令單號" DataType="System.String"/>
        <Column Name="生產單位" DataType="System.String"/>
        <Column Name="預計產量" DataType="System.Decimal"/>
        <Column Name="生產量" DataType="System.Decimal"/>
        <Column Name="淨重" DataType="System.Decimal"/>
        <Column Name="單片重" DataType="System.Decimal"/>
        <Column Name="袋重" DataType="System.Decimal"/>
        <Column Name="袋重比" DataType="System.Decimal"/>
        <Column Name="蒸發率" DataType="System.Decimal"/>
        <Column Name="原料用量" DataType="System.Decimal"/>
        <Column Name="成品用量" DataType="System.Decimal"/>
        <Column Name="類別" DataType="System.String"/>
        <Column Name="領料是否扣袋重" DataType="System.String"/>
        <Column Name="成品是否扣袋重" DataType="System.String"/>
        <Column Name="領料扣成品扣的得料率" DataType="System.Decimal"/>
        <Column Name="領料扣成品不扣的得料率" DataType="System.Decimal"/>
        <Column Name="領料不扣成品扣的得料率" DataType="System.Decimal"/>
        <Column Name="領料不扣成品不扣的得料率" DataType="System.Decimal"/>
        <Column Name="片得料率" DataType="System.Decimal"/>
        <Column Name="單包得料率" DataType="System.Decimal"/>
        <Column Name="kg得料率" DataType="System.Decimal"/>
        <Column Name="得料率" DataType="System.Decimal"/>
        <Column Name="分子" DataType="System.Decimal"/>
        <Column Name="分母" DataType="System.Decimal"/>
        <Column Name="桶數" DataType="System.Decimal"/>
        <Column Name="半成品得料率成品扣袋重" DataType="System.Decimal"/>
        <Column Name="半成品得料率成品不扣袋重" DataType="System.Decimal"/>
        <Column Name="個試吃得料率" DataType="System.Decimal"/>
        <Column Name="過篩後得料率" DataType="System.Decimal"/>
      </TableDataSource>
    </MsSqlDataConnection>
  </Dictionary>
  <ReportPage Name="Page1" Landscape="true" PaperWidth="600" PaperHeight="210">
    <ReportTitleBand Name="ReportTitle1" Width="2192.4" Height="18.9">
      <TextObject Name="Text1" Left="103.95" Width="2050.65" Height="18.9" Text="生線線別-得料率" HorzAlign="Center" VertAlign="Center"/>
    </ReportTitleBand>
    <ColumnHeaderBand Name="ColumnHeader1" Top="23.5" Width="2192.4" Height="18.9" CanGrow="true" Guides="0">
      <TextObject Name="Text3" Width="113.4" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="線別" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text5" Left="113.4" Width="75.6" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="日期" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text7" Left="189" Width="113.4" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="品號" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text9" Left="302.4" Width="236.25" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="品名" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text11" Left="538.65" Width="179.55" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="規格" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text13" Left="718.2" Width="66.15" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="製令單別" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text15" Left="784.35" Width="94.5" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="製令單號" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text17" Left="878.85" Width="75.6" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="生產單位" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text19" Left="954.45" Width="75.6" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="製令數量" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text21" Left="1030.05" Width="75.6" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="成品總數" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text36" Left="1105.65" Width="103.95" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text=" 誤差值" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text39" Left="1209.6" Width="85.05" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="製造總產出" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text35" Left="1379.7" Width="66.15" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="得料率%" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text23" Left="1691.55" Width="75.6" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="淨重g" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text25" Left="1767.15" Width="66.15" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="單片重g" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text27" Left="1833.3" Width="66.15" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="袋重g" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text29" Left="1899.45" Width="66.15" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="蒸發率%" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text31" Left="1540.35" Width="75.6" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="原料用量KG" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text33" Left="1615.95" Width="75.6" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="成品用量KG" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text41" Left="1294.65" Width="85.05" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="製造投入量" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text43" Left="1965.6" Width="94.5" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="分子" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text45" Left="2060.1" Width="94.5" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="分母" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text47" Left="1445.85" Width="94.5" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="桶數" HorzAlign="Center" VertAlign="Center"/>
    </ColumnHeaderBand>
    <DataBand Name="Data1" Top="47" Width="2192.4" Height="18.9" CanGrow="true" DataSource="Table">
      <TextObject Name="Text2" Width="113.4" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[Table.線別]" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text4" Left="113.4" Width="75.6" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[Table.日期]" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text6" Left="189" Width="113.4" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[Table.品號]" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text8" Left="302.4" Width="236.25" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[Table.品名]" VertAlign="Center"/>
      <TextObject Name="Text10" Left="538.65" Width="179.55" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[Table.規格]" VertAlign="Center"/>
      <TextObject Name="Text12" Left="718.2" Width="66.15" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[Table.製令單別]" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text14" Left="784.35" Width="94.5" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[Table.製令單號]" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text16" Left="878.85" Width="75.6" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[Table.生產單位]" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text18" Left="954.45" Width="75.6" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[Table.預計產量]" Format="Number" Format.UseLocale="false" Format.DecimalDigits="0" Format.DecimalSeparator="." Format.GroupSeparator="," Format.NegativePattern="1" HorzAlign="Right" VertAlign="Center" WordWrap="false" Trimming="EllipsisCharacter"/>
      <TextObject Name="Text20" Left="1030.05" Width="75.6" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[Table.生產量]" Format="Number" Format.UseLocale="false" Format.DecimalDigits="0" Format.DecimalSeparator="." Format.GroupSeparator="," Format.NegativePattern="1" HorzAlign="Right" VertAlign="Center" WordWrap="false" Trimming="EllipsisCharacter"/>
      <TextObject Name="Text22" Left="1691.55" Width="75.6" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[Table.淨重]" Format="Number" Format.UseLocale="false" Format.DecimalDigits="0" Format.DecimalSeparator="." Format.GroupSeparator="," Format.NegativePattern="1" HorzAlign="Right" VertAlign="Center" WordWrap="false" Trimming="EllipsisCharacter"/>
      <TextObject Name="Text24" Left="1767.15" Width="66.15" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[Table.單片重]" Format="Number" Format.UseLocale="true" HorzAlign="Right" VertAlign="Center" WordWrap="false" Trimming="EllipsisCharacter"/>
      <TextObject Name="Text26" Left="1833.3" Width="66.15" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[Table.袋重]" Format="Number" Format.UseLocale="true" HorzAlign="Right" VertAlign="Center" WordWrap="false" Trimming="EllipsisCharacter"/>
      <TextObject Name="Text28" Left="1899.45" Width="66.15" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[Table.蒸發率]" Format="Number" Format.UseLocale="true" HorzAlign="Right" VertAlign="Center" WordWrap="false" Trimming="EllipsisCharacter"/>
      <TextObject Name="Text37" Left="1105.65" Width="103.95" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[[Table.生產量]-[Table.預計產量]]" Format="Number" Format.UseLocale="false" Format.DecimalDigits="0" Format.DecimalSeparator="." Format.GroupSeparator="," Format.NegativePattern="1" HorzAlign="Right" VertAlign="Center" WordWrap="false" Trimming="EllipsisCharacter"/>
      <TextObject Name="Text38" Left="1209.6" Width="85.05" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[Table.分子]" Format="Number" Format.UseLocale="true" HorzAlign="Right" VertAlign="Center" WordWrap="false" Trimming="EllipsisCharacter"/>
      <TextObject Name="Text40" Left="1294.65" Width="85.05" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[Table.分母]" Format="Number" Format.UseLocale="true" HorzAlign="Right" VertAlign="Center" WordWrap="false" Trimming="EllipsisCharacter"/>
      <TextObject Name="Text30" Left="1540.35" Width="75.6" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[Table.原料用量]" Format="Number" Format.UseLocale="true" HorzAlign="Right" VertAlign="Center" WordWrap="false" Trimming="EllipsisCharacter"/>
      <TextObject Name="Text32" Left="1615.95" Width="75.6" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[Table.成品用量]" Format="Number" Format.UseLocale="true" HorzAlign="Right" VertAlign="Center" WordWrap="false" Trimming="EllipsisCharacter"/>
      <TextObject Name="Text34" Left="1379.7" Width="66.15" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[Table.得料率]" Format="Percent" Format.UseLocale="true" HorzAlign="Right" VertAlign="Center" WordWrap="false" Trimming="EllipsisCharacter"/>
      <TextObject Name="Text42" Left="1965.6" Width="94.5" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[Table.分子]" Format="Number" Format.UseLocale="true" HorzAlign="Center" VertAlign="Center" WordWrap="false" Trimming="EllipsisCharacter"/>
      <TextObject Name="Text44" Left="2060.1" Width="94.5" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[Table.分母]" Format="Number" Format.UseLocale="true" HorzAlign="Right" VertAlign="Center" WordWrap="false" Trimming="EllipsisCharacter"/>
      <TextObject Name="Text46" Left="1445.85" Width="94.5" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[Table.桶數]" Format="Number" Format.UseLocale="false" Format.DecimalDigits="3" Format.DecimalSeparator="." Format.GroupSeparator="," Format.NegativePattern="1" HorzAlign="Center" VertAlign="Center" WordWrap="false" Trimming="EllipsisCharacter"/>
    </DataBand>
    <PageFooterBand Name="PageFooter1" Top="70.49" Width="2192.4" Height="18.9"/>
  </ReportPage>
</Report>
