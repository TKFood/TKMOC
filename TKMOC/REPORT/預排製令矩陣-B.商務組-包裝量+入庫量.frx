<?xml version="1.0" encoding="utf-8"?>
<Report ScriptLanguage="CSharp" ReportInfo.Created="12/01/2021 13:43:35" ReportInfo.Modified="12/01/2021 13:56:19" ReportInfo.CreatorVersion="2016.4.4.0">
  <Dictionary>
    <MsSqlDataConnection Name="Connection" ConnectionString="rijcmlqHwzMSgwTFaHpjtG3vsOj8Zy6q+uhwpDsytgWqwZQZyEQUQyQ022aWUGqU90pHzzNjHuzu89K+RQ2LIBVx1fpgNkNJhwC4eetn2/Uy0fMrO7zDUE5AmRb+0bcYI+lxqpN+i5gA3VDGcwlcfm6L9ZMsLrZ3U+wEDtHCQtd9vw2XUGon6N0y8x++O80EXw+2Uli">
      <TableDataSource Name="Table" DataType="System.Int32" Enabled="true" SelectCommand="SELECT MANU,MANUDATE,[MB002],BAR,NUM,PACKAGE,TD00123,TC053,MV002,MOCTA001002,入庫量,[NO],TA033,MOCTA001A,MOCTA002B,MOCTA001B,MOCTA002B&#13;&#10;FROM (&#13;&#10;SELECT  [MOCMANULINE].[MANU] ,CONVERT(nvarchar,[MOCMANULINE].[MANUDATE],112) MANUDATE,[MOCMANULINE].[MB002]&#13;&#10;,ISNULL([MOCMANULINE].[BAR],0) BAR,ISNULL([MOCMANULINE].[NUM],0) NUM,ISNULL([MOCMANULINE].[PACKAGE],0) PACKAGE&#13;&#10;,[MOCMANULINE].[COPTD001]+' '+[MOCMANULINE].[COPTD002]+' '+[MOCMANULINE].[COPTD003] AS TD00123&#13;&#10;,[COPTC].TC053,[CMSMV].MV002&#13;&#10;,ISNULL([MOCMANULINERESULT].[MOCTA001],'')+ISNULL([MOCMANULINERESULT].[MOCTA002],'')+ISNULL([MOCTA].TA001,'')+ISNULL([MOCTA].TA002,'') AS 'MOCTA001002' &#13;&#10;,(SELECT ISNULL(SUM(TG011),0) FROM  [TK].dbo.[MOCTG] WHERE TG014=[MOCMANULINERESULT].[MOCTA001] AND TG015=[MOCMANULINERESULT].[MOCTA002])+(SELECT ISNULL(SUM(TG011),0) FROM  [TK].dbo.[MOCTG] WHERE TG014=[MOCTA].TA001 AND TG015=[MOCTA].TA002)  AS '入庫量'  &#13;&#10;,(SELECT ISNULL(SUM(TG011),0) FROM  [TK].dbo.[MOCTG] WHERE TG014=[MOCMANULINERESULT].[MOCTA001] AND TG015=[MOCMANULINERESULT].[MOCTA002]) AS '入庫量A'  &#13;&#10;,(SELECT ISNULL(SUM(TG011),0) FROM  [TK].dbo.[MOCTG] WHERE TG014=[MOCTA].TA001 AND TG015=[MOCTA].TA002)  AS '入庫量B'              &#13;&#10;,[MOCMANULINEMERGE].[NO],[MOCTA].TA033,ISNULL([MOCMANULINERESULT].[MOCTA001],'') AS MOCTA001A,ISNULL([MOCMANULINERESULT].[MOCTA002],'')  AS MOCTA002A,ISNULL([MOCTA].TA001,'')  AS MOCTA001B,ISNULL([MOCTA].TA002,'')  AS MOCTA002B  &#13;&#10;FROM [TKMOC].[dbo].[MOCMANULINE]&#13;&#10;LEFT JOIN [TK].dbo.[COPTD] ON [MOCMANULINE].[COPTD001]=[COPTD].TD001 AND [MOCMANULINE].[COPTD002]=[COPTD].TD002 AND[MOCMANULINE].[COPTD003]=[COPTD].TD003 &#13;&#10;LEFT JOIN [TK].dbo.[COPTC] ON [COPTD].TD001=[COPTC].TC001 AND [COPTD].TD002=[COPTC].TC002&#13;&#10;LEFT JOIN [TK].dbo.[CMSMV] ON [CMSMV].MV001=[COPTC].TC006&#13;&#10;LEFT JOIN [TKMOC].[dbo].[MOCMANULINERESULT] ON [MOCMANULINERESULT].[SID]=[MOCMANULINE].[ID]&#13;&#10;LEFT JOIN [TKMOC].[dbo].[MOCMANULINEMERGE] ON [MOCMANULINEMERGE].[SID]=[MOCMANULINE].[ID]  &#13;&#10;LEFT JOIN [TK].dbo.[MOCTA] ON [MOCTA].TA033=[MOCMANULINEMERGE].[NO]  &#13;&#10;WHERE CONVERT(nvarchar,[MOCMANULINE].[MANUDATE],112)&gt;='20211201' AND CONVERT(nvarchar,[MOCMANULINE].[MANUDATE],112)&lt;='20211201'&#13;&#10;AND [MOCMANULINE].[MB001] NOT IN (SELECT MB001 FROM  [TKMOC].[dbo].[MOCMANULINELIMITBARCOUNT])&#13;&#10;UNION ALL  &#13;&#10;SELECT  [MOCMANULINETEMP].[MANU] ,CONVERT(nvarchar,dateadd(ms,-3,dateadd(yy, datediff(yy,0,getdate())+2, 0)) ,112) MANUDATE,[MOCMANULINETEMP].[MB002]&#13;&#10;,ISNULL([MOCMANULINETEMP].[BAR],0) BAR,ISNULL([MOCMANULINETEMP].[NUM],0) NUM,ISNULL([MOCMANULINETEMP].[PACKAGE],0) PACKAGE&#13;&#10;,[MOCMANULINETEMP].[COPTD001]+' '+[MOCMANULINETEMP].[COPTD002]+' '+[MOCMANULINETEMP].[COPTD003] AS TD00123&#13;&#10;,[COPTC].TC053,[CMSMV].MV002&#13;&#10;,ISNULL([MOCMANULINERESULT].[MOCTA001],'')+ISNULL([MOCMANULINERESULT].[MOCTA002],'')+ISNULL([MOCTA].TA001,'')+ISNULL([MOCTA].TA002,'') AS 'MOCTA001002' &#13;&#10;,(SELECT ISNULL(SUM(TG011),0) FROM  [TK].dbo.[MOCTG] WHERE TG014=[MOCMANULINERESULT].[MOCTA001] AND TG015=[MOCMANULINERESULT].[MOCTA002])+(SELECT ISNULL(SUM(TG011),0) FROM  [TK].dbo.[MOCTG] WHERE TG014=[MOCTA].TA001 AND TG015=[MOCTA].TA002)  AS '入庫量'  &#13;&#10;,(SELECT ISNULL(SUM(TG011),0) FROM  [TK].dbo.[MOCTG] WHERE TG014=[MOCMANULINERESULT].[MOCTA001] AND TG015=[MOCMANULINERESULT].[MOCTA002]) AS '入庫量A'  &#13;&#10;,(SELECT ISNULL(SUM(TG011),0) FROM  [TK].dbo.[MOCTG] WHERE TG014=[MOCTA].TA001 AND TG015=[MOCTA].TA002)  AS '入庫量B'  &#13;&#10;,[MOCMANULINEMERGE].[NO],[MOCTA].TA033,ISNULL([MOCMANULINERESULT].[MOCTA001],'') AS MOCTA001A,ISNULL([MOCMANULINERESULT].[MOCTA002],'')  AS MOCTA002A,ISNULL([MOCTA].TA001,'')  AS MOCTA001B,ISNULL([MOCTA].TA002,'')  AS MOCTA002B  &#13;&#10;FROM [TKMOC].[dbo].[MOCMANULINETEMP]  &#13;&#10;LEFT JOIN [TK].dbo.[COPTD] ON [MOCMANULINETEMP].[COPTD001]=[COPTD].TD001 AND [MOCMANULINETEMP].[COPTD002]=[COPTD].TD002 AND[MOCMANULINETEMP].[COPTD003]=[COPTD].TD003   &#13;&#10;LEFT JOIN [TK].dbo.[COPTC] ON [COPTD].TD001=[COPTC].TC001 AND [COPTD].TD002=[COPTC].TC002  &#13;&#10;LEFT JOIN [TK].dbo.[CMSMV] ON [CMSMV].MV001=[COPTC].TC006  &#13;&#10;LEFT JOIN [TKMOC].[dbo].[MOCMANULINE] ON [MOCMANULINE].ID=[MOCMANULINETEMP].TID  &#13;&#10;LEFT JOIN [TKMOC].[dbo].[MOCMANULINERESULT] ON [MOCMANULINERESULT].[SID]=[MOCMANULINE].[ID]  &#13;&#10;LEFT JOIN [TKMOC].[dbo].[MOCMANULINEMERGE] ON [MOCMANULINEMERGE].[SID]=[MOCMANULINE].[ID]  &#13;&#10;LEFT JOIN [TK].dbo.[MOCTA] ON [MOCTA].TA033=[MOCMANULINEMERGE].[NO]  &#13;&#10;WHERE CONVERT(nvarchar,[MOCMANULINETEMP].[MANUDATE],112)&gt;='20211201' AND CONVERT(nvarchar,[MOCMANULINETEMP].[MANUDATE],112)&lt;='20211201' &#13;&#10;AND [MOCMANULINETEMP].TID IS NULL  &#13;&#10;AND [MOCMANULINE].[MB001] NOT IN (SELECT MB001 FROM  [TKMOC].[dbo].[MOCMANULINELIMITBARCOUNT])&#13;&#10;) AS TEMP&#13;&#10;&#13;&#10;ORDER BY  TEMP.[MANU],CONVERT(nvarchar, TEMP.[MANUDATE],112)">
        <Column Name="MANU" DataType="System.String"/>
        <Column Name="MANUDATE" DataType="System.String"/>
        <Column Name="MB002" DataType="System.String"/>
        <Column Name="BAR" DataType="System.Decimal"/>
        <Column Name="NUM" DataType="System.Decimal"/>
        <Column Name="PACKAGE" DataType="System.Decimal"/>
        <Column Name="TD00123" DataType="System.String"/>
        <Column Name="TC053" DataType="System.String"/>
        <Column Name="MV002" DataType="System.String"/>
        <Column Name="MOCTA001002" DataType="System.String"/>
        <Column Name="入庫量" DataType="System.Decimal"/>
        <Column Name="NO" DataType="System.String"/>
        <Column Name="TA033" DataType="System.String"/>
        <Column Name="MOCTA001A" DataType="System.String"/>
        <Column Name="MOCTA002B" DataType="System.String"/>
        <Column Name="MOCTA001B" DataType="System.String"/>
        <Column Name="MOCTA002B1" DataType="System.String"/>
      </TableDataSource>
    </MsSqlDataConnection>
  </Dictionary>
  <ReportPage Name="Page1" Landscape="true" PaperWidth="340" PaperHeight="210">
    <ReportTitleBand Name="ReportTitle1" Width="1209.6" Height="18.9">
      <TextObject Name="Text2" Width="66.15" Height="18.9" Border.Lines="All" Text="線別" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text4" Left="66.15" Width="94.5" Height="18.9" Border.Lines="All" Text="預計日期" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text6" Left="160.65" Width="160.65" Height="18.9" Border.Lines="All" Text="訂單" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text8" Left="396.9" Width="160.65" Height="18.9" Border.Lines="All" Text="客戶" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text10" Left="321.3" Width="75.6" Height="18.9" Border.Lines="All" Text="業務" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text12" Left="557.55" Width="255.15" Height="18.9" Border.Lines="All" Text="品名" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text14" Left="812.7" Width="132.3" Height="18.9" Border.Lines="All" Text="製令" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text16" Left="945" Width="94.5" Height="18.9" Border.Lines="All" Text="包裝量" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text18" Left="1039.5" Width="94.5" Height="18.9" Border.Lines="All" Text="入庫量" HorzAlign="Center" VertAlign="Center"/>
    </ReportTitleBand>
    <DataBand Name="Data1" Top="23.39" Width="1209.6" Height="18.9" CanGrow="true" DataSource="Table">
      <TextObject Name="Text1" Width="66.15" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[Table.MANU]" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text3" Left="66.15" Width="94.5" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[Table.MANUDATE]" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text5" Left="160.65" Width="160.65" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[Table.TD00123]" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text7" Left="396.9" Width="160.65" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[Table.TC053]" VertAlign="Center"/>
      <TextObject Name="Text9" Left="321.3" Width="75.6" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[Table.MV002]" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text11" Left="557.55" Width="255.15" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[Table.MB002]" VertAlign="Center"/>
      <TextObject Name="Text13" Left="812.7" Width="132.3" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[Table.MOCTA001002]" HorzAlign="Center" VertAlign="Center"/>
      <TextObject Name="Text15" Left="945" Width="94.5" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[Table.PACKAGE]" Format="Number" Format.UseLocale="false" Format.DecimalDigits="0" Format.DecimalSeparator="." Format.GroupSeparator="," Format.NegativePattern="1" HorzAlign="Right" VertAlign="Center" WordWrap="false" Trimming="EllipsisCharacter"/>
      <TextObject Name="Text17" Left="1039.5" Width="94.5" Height="18.9" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[Table.入庫量]" Format="Number" Format.UseLocale="false" Format.DecimalDigits="0" Format.DecimalSeparator="." Format.GroupSeparator="," Format.NegativePattern="1" HorzAlign="Right" VertAlign="Center" WordWrap="false" Trimming="EllipsisCharacter"/>
    </DataBand>
  </ReportPage>
</Report>
